(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cf1878a6"],{"2bb5":function(e,r,t){"use strict";t.d(r,"a",(function(){return s}));var a=t("d4ec"),i=t("bee2"),n=t("bc3a"),o=t.n(n),s=function(){function e(){Object(a["a"])(this,e)}return Object(i["a"])(e,[{key:"getAllRoles",value:function(e){return o.a.post("https://veterinariaapi.herokuapp.com/api/roles/all/",e)}},{key:"createRol",value:function(e){return o.a.post("https://veterinariaapi.herokuapp.com/api/roles/create/",e)}},{key:"createRolPermiso",value:function(e){return o.a.post("https://veterinariaapi.herokuapp.com/api/roles/permisos/",e)}},{key:"editRol",value:function(e){return o.a.put("https://veterinariaapi.herokuapp.com/api/roles/",e)}},{key:"getRolById",value:function(e){return o.a.get("https://veterinariaapi.herokuapp.com/api/roles/"+e)}},{key:"deleteRol",value:function(e){return o.a.delete("https://veterinariaapi.herokuapp.com/api/roles/"+e)}},{key:"getAllPermisos",value:function(){return o.a.get("https://veterinariaapi.herokuapp.com/api/permisos/")}}]),e}()},"6a12":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("v-row",[t("v-col",{staticClass:"text-h5",attrs:{cols:"12"}},[e._v(" Creación de usuarios "),t("hr")]),t("v-col",{attrs:{cols:"12"}},[t("v-form",{ref:"formUser",attrs:{"lazy-validation":""},model:{value:e.validUser,callback:function(r){e.validUser=r},expression:"validUser"}},[t("v-row",[t("v-col",{attrs:{cols:"12",md:"4"}},[t("v-text-field",{attrs:{rules:[function(e){return!!e||"La identificación es requerida"}],maxlength:"30",label:"Identificación",required:"",dense:"","hide-details":""},model:{value:e.usuario.identificacion,callback:function(r){e.$set(e.usuario,"identificacion",r)},expression:"usuario.identificacion"}})],1),t("v-col",{attrs:{cols:"12",md:"4"}},[t("v-text-field",{attrs:{rules:[function(e){return!!e||"El username es requerido"}],maxlength:"30",label:"Username",required:"",dense:"","hide-details":""},model:{value:e.usuario.username,callback:function(r){e.$set(e.usuario,"username",r)},expression:"usuario.username"}})],1),t("v-col",{attrs:{cols:"12",md:"4"}},[t("v-text-field",{attrs:{rules:[function(e){return!!e||"El nombre de usuario es requerido"}],maxlength:"30",label:"Nombre",required:"",dense:"","hide-details":""},model:{value:e.usuario.nombre,callback:function(r){e.$set(e.usuario,"nombre",r)},expression:"usuario.nombre"}})],1),t("v-col",{attrs:{cols:"12",md:"4"}},[t("v-text-field",{attrs:{rules:[function(e){return!!e||"Los apellidos son requerido"}],maxlength:"30",label:"Apellidos",required:"",dense:"","hide-details":""},model:{value:e.usuario.apellidos,callback:function(r){e.$set(e.usuario,"apellidos",r)},expression:"usuario.apellidos"}})],1),t("v-col",{attrs:{cols:"12",md:"4"}},[t("v-text-field",{attrs:{rules:[function(e){return!!e||"El teléfono es requerido"}],maxlength:"30",label:"Telefono",required:"",dense:"","hide-details":""},model:{value:e.usuario.telefono,callback:function(r){e.$set(e.usuario,"telefono",r)},expression:"usuario.telefono"}})],1),t("v-col",{attrs:{cols:"12",md:"4"}},[t("v-text-field",{attrs:{rules:[function(e){return!!e||"El email es requerido"}],maxlength:"30",label:"Email",required:"",dense:"","hide-details":""},model:{value:e.usuario.email,callback:function(r){e.$set(e.usuario,"email",r)},expression:"usuario.email"}})],1),t("v-col",{attrs:{cols:"12",md:"4"}},[t("v-text-field",{attrs:{rules:[function(e){return!!e||"El password es requerido"}],maxlength:"30",label:"Password",required:"",dense:"","hide-details":""},model:{value:e.usuario.password,callback:function(r){e.$set(e.usuario,"password",r)},expression:"usuario.password"}})],1),t("v-col",{attrs:{cols:"12",md:"4"}},[t("v-select",{attrs:{"return-object":"","item-text":"rol",items:e.roles,label:"Rol",dense:"",rules:[function(e){return!!e||"El password es requerido"}]},model:{value:e.rol,callback:function(r){e.rol=r},expression:"rol"}})],1)],1)],1)],1),t("v-col",{attrs:{cols:"12",sm:"6",md:"3"}},[t("v-btn",{staticClass:"ml-3",attrs:{color:"primary",dark:""},on:{click:function(r){return e.guardar()}}},[e._v("Guardar")]),t("v-btn",{staticClass:"ml-3",attrs:{color:"error",dark:""},on:{click:function(r){return e.$router.push({name:"UsuariosList"})}}},[e._v("Cancelar")])],1)],1)},i=[],n=(t("96cf"),t("1da1")),o=t("5530"),s=t("2f62"),u=t("b132"),c=t("2bb5"),l=t("e0c2"),d={mixins:[u["a"]],name:"roles-create",data:function(){return{usersService:null,rolesService:null,rol:null,type:"create",permisos:[],finca_id:null,usuario_id:null,permisoSelected:[],roles:[],usuario:{identificacion:"",username:"",nombre:"",apellidos:"",telefono:"",email:"",password:"",type:0,finca_id:null},nombreRules:[function(e){return!!e||"El nombre es requerido"},function(e){return e.length<=100||"El nombre debe tener menos de 100 caracteres"}],direccionRules:[function(e){return!!e||"La dirección es requerida"},function(e){return e.length<=250||"La dirección debe tener menos de 250 caracteres"}],validUser:!1}},created:function(){this.rolesService=new c["a"],this.usersService=new l["a"]},mounted:function(){this.$route.params.id?(this.finca_id=this.getFinca.id,this.usuario_id=this.getUsuario.id,this.recuperarDataUser()):(this.finca_id=this.getFinca.id,this.usuario_id=this.getUsuario.id,this.usuario.finca_id=this.finca_id),this.recuperarRoles()},methods:Object(o["a"])(Object(o["a"])({},Object(s["c"])([])),{},{recuperarDataUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.type="edit",r.next=3,e.usersService.getUserById(e.$route.params.id).then((function(r){t=r.data.data.rol_id,e.usuario=Object(o["a"])({},r.data.data),e.usuario.finca_id=e.finca_id})).catch((function(e){console.log(e)}));case 3:return r.next=5,e.rolesService.getRolById(t).then((function(r){e.rol=r.data.data.rol})).catch((function(e){console.log(e)}));case 5:case"end":return r.stop()}}),r)})))()},recuperarRoles:function(){var e=this,r={finca_id:this.getFinca.id,usuario_id:this.getUsuario.id,token:this.getToken};this.rolesService.getAllRoles(r).then((function(r){e.roles=r.data.data})).catch((function(){}))},guardar:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.$refs.formUser.validate()){r.next=7;break}return r.next=3,e.usersService.createUser(e.usuario).then((function(e){t=e.data.id_creado})).catch((function(){return!1}));case 3:return r.next=5,e.usersService.createFincaUser({usuario_id:t,finca_id:e.finca_id}).then((function(){})).catch((function(){return!1}));case 5:return r.next=7,e.usersService.createRolUser({usuario_id:t,rol_id:e.rol.id}).then((function(){var r={text:"Registro creado exitosamente",snackbar:!0,color:"success"};e.$emit("mostrarMensaje",r),setTimeout((function(){e.$router.push({name:"UsuariosList"})}),2e3)})).catch((function(){return!1}));case 7:return r.abrupt("return",!1);case 8:case"end":return r.stop()}}),r)})))()}}),computed:Object(o["a"])({},Object(s["b"])(["getFinca","getUsuario"]))},f=d,m=t("2877"),p=t("6544"),h=t.n(p),v=t("8336"),b=t("62ad"),g=t("4bd4"),x=t("0fd9"),k=t("b974"),w=t("8654"),_=Object(m["a"])(f,a,i,!1,null,"4889f9b2",null);r["default"]=_.exports;h()(_,{VBtn:v["a"],VCol:b["a"],VForm:g["a"],VRow:x["a"],VSelect:k["a"],VTextField:w["a"]})},b132:function(e,r,t){"use strict";t.d(r,"a",(function(){return i}));t("7db0"),t("d3b7"),t("25f0");var a=t("07a4"),i={methods:{tienePermiso:function(e){return a["a"].getters.getPermisosDetallados.find((function(r){return r==e}))},colorAleatorio:function(){for(var e=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"),r="#",t=0;t<6;t++){var a=e.length-0,i=Math.random()*a;i=Math.floor(i);var n=parseInt(0)+i;r+=e[n]}return r},generarToken:function(){return Math.random().toString(36).substring(2,13)+Math.random().toString(36).substring(2,13)}}}}}]);
//# sourceMappingURL=chunk-cf1878a6.eadd583b.js.map